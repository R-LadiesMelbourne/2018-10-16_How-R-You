<!DOCTYPE html>
<html>
  <head>
    <title>Matching Strings</title>
    <meta charset="utf-8">
    <meta name="author" content="Saskia Freytag" />
    <meta name="date" content="2018-10-02" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/rladies.css" rel="stylesheet" />
    <link href="libs/remark-css/rladies-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Matching Strings
## <br/> Are you ü§¢ yet?
### Saskia Freytag
### 2018-10-02

---




# üòé "I just need to match these real quickly!" 


- Nearly every day I am asked to look up a set of genes in one of my dataset. For example like these ones: 


```r
interesting_genes &lt;- c("OR2A25", "PGAM1", "KAZALD1", "GABRG3")
```

--

- This cannot be done manually as my typical dataset includes around 64661 genes. 

---
- Just for you to get an idea, my typical dataset looks somewhat like this:


```r
knitr::kable(gene_data[1:5,1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11869 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14409 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2541 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000223972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; DDX11L1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14404 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29570 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15167 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; - &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000227232 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; WASH7P &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17369 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17436 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 68 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; - &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000278267 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MIR6859-1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29554 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1556 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000243485 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MIR1302-2HG &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30366 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30503 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 138 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000284332 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MIR1302-2 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# üí∏ "I am drowning in solutions"

**Old School**:
(i.e. I know very few functions)


```r
index &lt;- which(is.element(gene_data$symbol, interesting_genes))
knitr::kable(gene_data[index, 1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97426160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97433441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7282 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000171314 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PGAM1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101061841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101068131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6291 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000107821 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KAZALD1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144069811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144075870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6060 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000221933 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR2A25 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

This feels dated üëµ!

And so difficult to read with all the üê£.

And the order changed.

---

**Matching**:


```r
index &lt;- match(interesting_genes, gene_data$symbol)
knitr::kable(gene_data[index, 1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144069811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144075870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6060 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000221933 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR2A25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97426160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97433441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7282 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000171314 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PGAM1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101061841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101068131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6291 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000107821 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KAZALD1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

So much better üòä!

---

**Partial Matching**:


```r
index &lt;- pmatch(interesting_genes, gene_data$symbol)
knitr::kable(gene_data[index, 1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144069811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144075870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6060 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000221933 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR2A25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97426160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97433441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7282 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000171314 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PGAM1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101061841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101068131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6291 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000107821 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KAZALD1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

This also works! üéâ

---

**Tidyverse solution**:


```r
solution &lt;- gene_data %&gt;% dplyr::filter(symbol %in% interesting_genes)
knitr::kable(solution[, 1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97426160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97433441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7282 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000171314 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PGAM1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101061841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101068131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6291 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000107821 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KAZALD1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144069811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144075870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6060 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000221933 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR2A25 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
 
The best yet! ü§ë 

Note that the order changed though!

---

# ‚è±  " Not all solutions are created equal! "



**Old School**:


```r
benchmark(
 times(100) %do% old_school(gene_data, interesting_genes)
)
```

```
##                                                       test replications
## 1 times(100) %do% old_school(gene_data, interesting_genes)          100
##   elapsed relative user.self sys.self user.child sys.child
## 1  36.077        1    32.194    3.845          0         0
```

For old school this is pretty fast. Verdict: üêé! 

---

**Matching**:


```r
benchmark(
 times(100) %do% matching(gene_data, interesting_genes)
)
```

```
##                                                     test replications
## 1 times(100) %do% matching(gene_data, interesting_genes)          100
##   elapsed relative user.self sys.self user.child sys.child
## 1  34.399        1    30.779    3.569          0         0
```

This is clearly üèé! 

---

**Partial Matching**:


```r
benchmark(
 times(100) %do% partial_matching(gene_data, interesting_genes)
)
```

```
##                                                             test
## 1 times(100) %do% partial_matching(gene_data, interesting_genes)
##   replications elapsed relative user.self sys.self user.child sys.child
## 1          100  23.317        1    20.347    2.952          0         0
```

Lightning fast like a üöÄ!

---

**Tidyverse Solution**:


```r
benchmark(
 times(100) %do% tidyverse_solution(gene_data, interesting_genes)
)
```

```
##                                                               test
## 1 times(100) %do% tidyverse_solution(gene_data, interesting_genes)
##   replications elapsed relative user.self sys.self user.child sys.child
## 1          100  46.863        1    42.755    4.029          0         0
```

I can only liken this to üêå speed! 

---

# ü§î "You can never be too caReful!"

- Let's imgine we wanted to look up some genes several times. Here we will use "GABRG3":


```r
interesting_genes &lt;- c("OR2A25", "PGAM1", "KAZALD1", "GABRG3", "GABRG3")
```

- Of course we will use the winner üèÜ of the speed race for this matching task.

--


```r
index &lt;- pmatch(interesting_genes, gene_data$symbol)
knitr::kable(gene_data[index, 1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144069811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144075870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6060 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000221933 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR2A25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97426160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97433441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7282 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000171314 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PGAM1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101061841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101068131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6291 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000107821 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KAZALD1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27157615 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27161319 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3705 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; - &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000228740 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3-AS1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# üò± "Oh no what is GABRG3-AS1 doing in my dataset!"

- You may think that simply setting `duplicates.ok=TRUE`, fixes your problem:


```r
index &lt;- pmatch(interesting_genes, gene_data$symbol, duplicates.ok=TRUE)
knitr::kable(gene_data[index, 1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144069811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144075870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6060 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000221933 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR2A25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97426160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97433441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7282 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000171314 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PGAM1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101061841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101068131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6291 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000107821 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KAZALD1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

Sure looks like it! üòÖ

---

- However what happens in this situation, where I have invented a non-existing gene GABRG3-A? ü§∑üèªÔ∏è 


```r
interesting_genes &lt;- c("OR2A25", "PGAM1", "KAZALD1", "GABRG3", "GABRG3-A")
index &lt;- pmatch(interesting_genes, gene_data$symbol, duplicates.ok=TRUE)
knitr::kable(gene_data[index, 1:7], format = 'html', row.names=FALSE)
```

---


```r
interesting_genes &lt;- c("OR2A25", "PGAM1", "KAZALD1", "GABRG3", "GABRG3-A")
index &lt;- pmatch(interesting_genes, gene_data$symbol, duplicates.ok=TRUE)
knitr::kable(gene_data[index, 1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144069811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144075870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6060 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000221933 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR2A25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97426160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97433441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7282 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000171314 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PGAM1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101061841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101068131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6291 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000107821 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KAZALD1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27157615 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27161319 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3705 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; - &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000228740 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3-AS1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**This is of course matched to GABRG3-AS1!**

‚ùóÔ∏è Actually this also happens when `duplicates.ok=FALSE` ‚ùóÔ∏è

---
# ‚õë "Trade speed for safety!"

Whenever you are unsure about the exact contents of your dataset, partial matching isn't the solution. Use simple matching to avoid all problems.


```r
interesting_genes &lt;- c("OR2A25", "PGAM1", "KAZALD1", "GABRG3", "GABRG3-A")
index &lt;- match(interesting_genes, gene_data$symbol)
knitr::kable(gene_data[index, 1:7], format = 'html', row.names=FALSE)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; seqnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; start &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; end &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strand &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene_id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; symbol &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144069811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 144075870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6060 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000221933 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR2A25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97426160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 97433441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7282 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000171314 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PGAM1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101061841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101068131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6291 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000107821 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KAZALD1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26971282 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27541991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 570710 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; + &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ENSG00000182256 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GABRG3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

üëçüëçüëç
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
